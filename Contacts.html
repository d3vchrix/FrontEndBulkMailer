<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="img/favicon.svg">
    <title>Dashboard - BulkMailer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Optic One</title>
</head>

<header>
    <div id="brand" aria-label="navigation bar">
        <div class="brand-container">
            <a class="logo" href="#"><img src="img/favicon.svg" /></a>
            <div class="account">
                <a href="#"><span>John Doe</span><i class="fa-solid fa-user"></i></a>
                <a asp-controller="Auth" asp-action="Logout"><span>Logout</span><i
                        class="fa-solid fa-right-from-bracket"></i></a>
                <!-- <a href="Auth.html">Login</a> -->
            </div>
        </div>
    </div>

    <div id="nav-menu" aria-label="navigation bar">
        <div class="menu-container">
            <div class="nav-start">
                <nav class="menu">
                    <ul class="menu-bar">
                        <li>
                            <a class="nav-link" asp-area="" asp-controller="Home" asp-action="Index" href="Index.html">
                                <span><i class="fa-solid fa-house"></i> Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-area="" asp-controller="Compose" asp-action="Index"
                                href="Compose.html">
                                <span><i class="fa-solid fa-envelope"></i> Compose</span>
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-area="" asp-controller="Compose" asp-action="Index"
                                href="Template.html">
                                <span><i class="fa-solid fa-cubes"></i> Template</span>
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-area="" asp-controller="Compose" asp-action="Index"
                                href="Contacts.html">
                                <span><i class="fa-solid fa-address-card"></i> Contacts</span>
                            </a>
                        </li>

                        <!-- <li>
                            <button class="nav-link dropdown-btn" data-dropdown="dropdown1" aria-haspopup="true"
                                aria-expanded="false">
                                <span> <i class="fa-solid fa-newspaper"></i>Templates</span>
                            </button>
                            <div id="dropdown1" class="dropdown">
                                <ul role="menu">
                                    <li role="menuitem">
                                        <a class="dropdown-link" asp-area="" asp-controller="Home" asp-action="Index">
                                            <span class="dropdown-link-title">Greetings</span>
                                        </a>
                                        <a class="dropdown-link" asp-area="" asp-controller="EmailTemplates"
                                            asp-action="Index" href="Templates/Email.html">
                                            <span class="dropdown-link-title">Email</span>
                                        </a>
                                        <a class="dropdown-link" asp-area="" asp-controller="Signatures"
                                            asp-action="Index">
                                            <span class="dropdown-link-title">Signature</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li> -->
                        <li>
                            <button class="nav-link dropdown-btn" data-dropdown="dropdown2" aria-haspopup="true"
                                aria-expanded="false">
                                <span><i class="fa-solid fa-cubes"></i>Cards</span>
                            </button>
                            <div id="dropdown2" class="dropdown">
                                <ul role="menu">
                                    <li role="menuitem">
                                        <a class="dropdown-link" asp-area="" asp-controller="Attachments"
                                            asp-action="Index">
                                            <span class="dropdown-link-title">Attachments</span>
                                        </a>
                                        <a class="dropdown-link" asp-area="" asp-controller="AttachmentTypes"
                                            asp-action="Index">
                                            <span class="dropdown-link-title">Attachments Types</span>
                                        </a>
                                        <a class="dropdown-link" asp-area="" asp-controller="DocumentTypes"
                                            asp-action="Index">
                                            <span class="dropdown-link-title">Document Types</span>
                                        </a>
                                        <a class="dropdown-link" asp-area="" asp-controller="Groups" asp-action="Index">
                                            <span class="dropdown-link-title">Groups</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li>
                            <button class="nav-link dropdown-btn" data-dropdown="dropdown3" aria-haspopup="true"
                                aria-expanded="false">
                                <span><i class="fa-solid fa-user-group"></i>Customers</span>
                            </button>
                            <div id="dropdown3" class="dropdown">
                                <ul role="menu">
                                    <li role="menuitem">
                                        <a class="dropdown-link" asp-area="" asp-controller="Customers"
                                            asp-action="Index">
                                            <span class="dropdown-link-title">Create</span>
                                        </a>
                                        <a class="dropdown-link" asp-area="" asp-controller="CustomerSettings"
                                            asp-action="Index">
                                            <span class="dropdown-link-title">Settings</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="nav-end">
                <div class="right-container">
                    <button id="hamburger" aria-label="hamburger" aria-haspopup="true" aria-expanded="false">
                        <i class="fa-solid fa-bars" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="body-container">
    <div class="content-container">
        <h2 class="text-center mb-4">CSV Import & Export</h2>
        <div class="mb-3 text-center">
            <input type="file" accept=".csv" class="form-control d-inline-block w-auto" onchange="importCSV(event)">
            <button class="btn btn-primary" onclick="exportCSV()">Export CSV</button>
        </div>
        <div class="mb-3">
            <input type="text" id="searchInput" class="form-control" placeholder="Search by Email or Name" onkeyup="filterTable()">
        </div>
        <div class="table-responsive">
            <table class="table table-bordered" id="csvTable"></table>
        </div>
        <!-- Insert Contents Here -->
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
<script src="https://kit.fontawesome.com/760c095f0a.js" crossorigin="anonymous"></script>
<script src="js/index.js"></script>
<script>
    function importCSV(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function (e) {
            const contents = e.target.result;
            const rows = contents.split("\n").map(row => row.split(","));
            if (rows.length > 1) {
                generateTable(rows.slice(1)); // Skip header row
            }
        };
        reader.readAsText(file);
    }


    function generateTable(data) {
        const table = document.getElementById("csvTable");
        table.innerHTML = "";

        // Create table header
        const thead = document.createElement("thead");
        thead.innerHTML = `<tr>
                <th>Email Address</th>
                <th>Name</th>
                <th>Action</th>
            </tr>`;
        table.appendChild(thead);

        // Create table body
        const tbody = document.createElement("tbody");
        if (data.length > 0) {
            data.forEach((row, index) => {
                if (row.length >= 2) {
                    const tr = document.createElement("tr");
                    tr.innerHTML = `<td>${row[0]}</td><td>${row[1]}</td>
                            <td><button class="btn btn-danger btn-sm" onclick="removeRow(this)">Remove</button></td>`;
                    tbody.appendChild(tr);
                }
            });
        }
        table.appendChild(tbody);
    }

    function removeRow(button) {
        const row = button.parentElement.parentElement;
        row.remove();
    }

    function exportCSV() {
        let csv = "Email,Name\n"; // Default header
        const rows = document.querySelectorAll("#csvTable tr");
        if (rows.length > 0) {
            csv = ""; // Reset if there are data rows
            rows.forEach(row => {
                const columns = row.querySelectorAll("td");
                csv += `${columns[0].innerText},${columns[1].innerText}\n`;
            });
        }

        const blob = new Blob([csv], { type: "text/csv" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "exported.csv";
        link.click();
    }
    function filterTable() {
            const searchInput = document.getElementById("searchInput").value.toLowerCase();
            const rows = document.querySelectorAll("#csvTable tbody tr");
            rows.forEach(row => {
                const email = row.cells[0].innerText.toLowerCase();
                const name = row.cells[1].innerText.toLowerCase();
                row.style.display = email.includes(searchInput) || name.includes(searchInput) ? "" : "none";
            });
        }
</script>

</html>
